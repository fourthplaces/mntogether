[package]
name = "api-core"
version.workspace = true
edition.workspace = true

[lib]
name = "api_core"
path = "src/lib.rs"

[[bin]]
name = "api"
path = "src/server/main.rs"

[dependencies]
# Async runtime
tokio = { workspace = true }
async-trait = "0.1"

# Error handling
anyhow = { workspace = true }
thiserror = { workspace = true }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }

# IDs and timestamps
uuid = { workspace = true }
chrono = { workspace = true }

# Logging
tracing = { workspace = true }
tracing-subscriber = { workspace = true }

# Event-driven architecture
seesaw = { path = "../seesaw-rs" }

# Database
sqlx = { workspace = true, features = ["migrate"] }
pgvector = { version = "0.4", features = ["sqlx"] }

# AI / LLM
rig-core = { workspace = true }

# GraphQL
juniper = { workspace = true }
juniper_axum = { workspace = true }

# HTTP server
axum = { workspace = true, features = ["multipart"] }
tower = { workspace = true }
tower-http = { workspace = true }
hyper = { version = "1", features = ["full"] }

# HTTP client (for Firecrawl, Tavily, Expo)
reqwest = { workspace = true }

# Authentication (admin only)
clerk-rs = "0.3"

# Cron jobs
tokio-cron-scheduler = "0.10"

# Static file embedding
rust-embed = "8.0"
mime_guess = "2.0"

# Environment
dotenvy = { workspace = true }

# Content hashing (duplicate detection)
sha2 = { workspace = true }

# Markdown rendering (optional - for display_markdown)
pulldown-cmark = "0.9"

[dev-dependencies]
# Testing
tokio-test = "0.4"
test-context = "0.3"
testcontainers = { workspace = true }
testcontainers-modules = { version = "0.11", features = ["postgres", "redis"] }
